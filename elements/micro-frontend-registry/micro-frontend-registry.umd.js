!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).MicroFrontendRegistry={})}(this,(function(t){"use strict";function e(t,e,n,r,o,i,c){try{var u=t[i](c),a=u.value}catch(t){return void n(t)}u.done?e(a):Promise.resolve(a).then(r,o)}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function o(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function i(t){return i=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},i(t)}function c(t,e){return c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},c(t,e)}function u(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function a(t,e,n){return a=u()?Reflect.construct:function(t,e,n){var r=[null];r.push.apply(r,e);var o=new(Function.bind.apply(t,r));return n&&c(o,n.prototype),o},a.apply(null,arguments)}function l(t){var e="function"==typeof Map?new Map:void 0;return l=function(t){if(null===t||(n=t,-1===Function.toString.call(n).indexOf("[native code]")))return t;var n;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,r)}function r(){return a(t,arguments,i(this).constructor)}return r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),c(r,t)},l(t)}function s(t,e){if(e&&("object"==typeof e||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}
/**
   * Copyright 2022 The Pennsylvania State University
   * @license Apache-2.0, see License.md for full text.
   */
var f=["endpoint","name","title","description","params","callback"],p=o((function t(){var e=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};n(this,t),f.map((function(t){return e[t]="params"===t?r[t]||{}:r[t]||null}))})),d=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&c(t,e)}(h,t);var r,a,l,d,y=(r=h,a=u(),function(){var t,e=i(r);if(a){var n=i(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return s(this,t)});function h(){var t;return n(this,h),(t=y.call(this)).list=[],t.MicroFrontend=p,t}return o(h,[{key:"define",value:function(t){if(t instanceof p||(console.warn("MicroFrontendRegistry: use class MicroFrontend instance but if keys match it will register still."),console.warn(t)),!Object.keys(t).every((function(t){return f.includes(t)})))return!1;if(t.endpoint.startsWith("/api/")){var e=window.location.origin.replace(/localhost:8(.*)/,"localhost:3000");t.endpoint="".concat(e).concat(t.endpoint)}return this.get(t.name)?void 0:(this.list.push(t),!0)}},{key:"get",value:function(t){if(t&&this.list.length>0){var e=this.list.find((function(e){return e.name===t}));if(e)return e}return null}},{key:"call",value:(l=regeneratorRuntime.mark((function t(e){var n,r,o,i,c,u=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=u.length>1&&void 0!==u[1]?u[1]:{},r=u.length>2&&void 0!==u[2]?u[2]:null,o=u.length>3&&void 0!==u[3]?u[3]:null,!(i=this.get(e))){t.next=15;break}return t.next=7,fetch(i.endpoint,{method:"POST",body:JSON.stringify(n)}).then((function(t){return t.ok?t.json():null}));case 7:if(c=t.sent,!i.callback){t.next=11;break}return t.next=11,i.callback(c,o);case 11:if(!r){t.next=14;break}return t.next=14,r(c,o);case 14:return t.abrupt("return",c);case 15:return t.abrupt("return",null);case 16:case"end":return t.stop()}}),t,this)})),d=function(){var t=this,n=arguments;return new Promise((function(r,o){var i=l.apply(t,n);function c(t){e(i,r,o,c,u,"next",t)}function u(t){e(i,r,o,c,u,"throw",t)}c(void 0)}))},function(t){return d.apply(this,arguments)})},{key:"url",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.get(t);for(var r in e)e.hasOwnProperty(r)&&null==e[r]&&delete e[r];return console.log(e),new URL(n.endpoint).toString()+"?".concat(new URLSearchParams(e).toString())}}],[{key:"tag",get:function(){return"micro-frontend-registry"}}]),h}(l(HTMLElement));customElements.define(d.tag,d),window.MicroFrontendRegistry=window.MicroFrontendRegistry||{},window.MicroFrontendRegistry.requestAvailability=function(){return window.MicroFrontendRegistry.instance||(window.MicroFrontendRegistry.instance=document.createElement(d.tag),document.body.appendChild(window.MicroFrontendRegistry.instance)),window.MicroFrontendRegistry.instance};var y=window.MicroFrontendRegistry.requestAvailability();t.MicroFrontend=p,t.MicroFrontendRegistry=y,Object.defineProperty(t,"__esModule",{value:!0})}));
