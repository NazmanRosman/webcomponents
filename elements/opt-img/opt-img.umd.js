!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).OptImg={})}(this,(function(e){"use strict";function t(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function n(e){return n=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},n(e)}function i(e,t){return i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},i(e,t)}function r(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function o(e,t,n){return o=r()?Reflect.construct.bind():function(e,t,n){var r=[null];r.push.apply(r,t);var o=new(Function.bind.apply(e,r));return n&&i(o,n.prototype),o},o.apply(null,arguments)}function c(e){var t="function"==typeof Map?new Map:void 0;return c=function(e){if(null===e||(r=e,-1===Function.toString.call(r).indexOf("[native code]")))return e;var r;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,c)}function c(){return o(e,arguments,n(this).constructor)}return c.prototype=Object.create(e.prototype,{constructor:{value:c,enumerable:!1,writable:!0,configurable:!0}}),i(c,e)},c(e)}function l(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function a(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=n(e)););return e}function s(){return s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var i=a(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(arguments.length<3?e:n):r.value}},s.apply(this,arguments)}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function d(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return u(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?u(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,c=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return c=e.done,e},e:function(e){l=!0,o=e},f:function(){try{c||null==n.return||n.return()}finally{if(l)throw o}}}}
/**
   * Copyright 2022 The Pennsylvania State University
   * @license Apache-2.0, see License.md for full text.
   */var f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&i(e,t)}(h,e);var o,c,a,u,f,p=(o=h,c=r(),function(){var e,t=n(o);if(c){var i=n(this).constructor;e=Reflect.construct(t,arguments,i)}else e=t.apply(this,arguments);return l(this,e)});function h(){var e;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,h),(e=p.call(this)).t=e.t||{},e.t.imageLoading="Image loading..",e.alt="",e.src="",e.width="300px",e.height="200px",e.querySelector("img")){var t=e.querySelector("img");e.alt=t.alt||"",e.src=t.src||"",e.width=t.width||"300px",e.height=t.height||"200px"}return e.innerHTML=null,e._loading=document.createElement("div"),e._loading.style.height=e.height,e._loading.style.width=e.width,e._loading.innerHTML=e.loading,e.appendChild(e._loading),e.loadingvisible=!1,e.template=document.createElement("template"),e._preconnect=document.createElement("link"),e._preconnect.rel="preconnect",e}return a=h,f=[{key:"observedAttributes",get:function(){return["src","alt","loadingvisible"]}},{key:"tag",get:function(){return"opt-img"}}],(u=[{key:"handleIntersectionCallback",value:function(e){var t,n=d(e);try{for(n.s();!(t=n.n()).done;){var i=t.value;Number(i.intersectionRatio).toFixed(2)>=.25?(this.loadingvisible=!0,this.intersectionObserver.disconnect()):this.loadingvisible=!1}}catch(e){n.e(e)}finally{n.f()}}},{key:"html",get:function(){return'<img \n    src="'.concat(this.src,'" \n    height="').concat(this.height,'" \n    width="').concat(this.width,'" \n    alt="').concat(this.alt,'" \n    decoding="async" \n    loading="lazy"\n    fetchpriority="high" />')}},{key:"loading",get:function(){return'\n    <style>\n    opt-img {\n      display: inline;\n    }\n    opt-img #dots circle{\n      animation: load 1s infinite;\n    }\n    \n    opt-img #dots #dot2{\n      animation-delay: 0.2s;\n    }\n    \n    opt-img #dots #dot3{\n      animation-delay: 0.4s;\n    }\n    \n    @keyframes load{\n      0%{\n        opacity: 0;\n      }\n      50%{\n        opacity: 1;\n      }\n      100%{\n        opacity: 0;\n      }\n    }\n    </style>\n    <svg id="dots-svg" width="132px" height="58px" viewBox="0 0 132 58" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">\n      <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" sketch:type="MSPage">\n          <g id="dots" sketch:type="MSArtboardGroup" fill="#A3A3A3">\n              <circle id="dot1" sketch:type="MSShapeGroup" cx="25" cy="30" r="13"></circle>\n              <circle id="dot2" sketch:type="MSShapeGroup" cx="65" cy="30" r="13"></circle>\n              <circle id="dot3" sketch:type="MSShapeGroup" cx="105" cy="30" r="13"></circle>\n          </g>\n      </g>\n    </svg>\n    <div aria-busy="true" aria-live="polite">'.concat(this.t.imageLoading,"</div>\n    ")}},{key:"attributeChangedCallback",value:function(e,t,n){["src","alt"].includes(e)?(this[e]=n,this.render()):["loadingvisible"].includes(e)&&this.render(),"src"===e&&(this._preconnect.href=new URL(this.src).origin,document.head.appendChild(this._preconnect))}},{key:"loadingvisible",get:function(){return this.getAttribute("loadingvisible")},set:function(e){!1===e?this.removeAttribute("loadingvisible"):this.setAttribute("loadingvisible","loadingvisible")}},{key:"render",value:function(){var e=this;if(this.loadingvisible){var t=new Image;t.fetchpriority="high",t.onload=function(){e.style.height=t.height+"px",e.style.width=t.width+"px",e.height=t.height+"px",e.width=t.width+"px",e.template.innerHTML=e.html,e.appendChild(e.template.content),setTimeout((function(){e.style.height="",e.style.width="",e._loading.remove()}),0)},t.src=this.src,this._preconnect.remove()}}},{key:"connectedCallback",value:function(){s(n(h.prototype),"connectedCallback",this)&&s(n(h.prototype),"connectedCallback",this).call(this),window.dispatchEvent(new CustomEvent("i18n-manager-register-element",{detail:{context:this,namespace:"opt-img",localesPath:new URL("./locales","undefined"==typeof document&&"undefined"==typeof location?new(require("url").URL)("file:"+__filename).href:"undefined"==typeof document?location.href:document.currentScript&&document.currentScript.src||new URL("opt-img.umd.js",document.baseURI).href).href,updateCallback:"render",locales:["es"]}})),this.loadingvisible||(this.intersectionObserver=new IntersectionObserver(this.handleIntersectionCallback.bind(this),{root:null,rootMargin:"0px",threshold:[0,.25,.5,.75,1],delay:500}),this.intersectionObserver.observe(this))}},{key:"disconnectedCallback",value:function(){this.intersectionObserver&&(this.intersectionObserver.disconnect(),this.loadingvisible=!1),s(n(h.prototype),"disconnectedCallback",this)&&s(n(h.prototype),"disconnectedCallback",this).call(this)}}])&&t(a.prototype,u),f&&t(a,f),Object.defineProperty(a,"prototype",{writable:!1}),h}(c(HTMLElement));customElements.define(f.tag,f),e.OptImg=f,Object.defineProperty(e,"__esModule",{value:!0})}));
