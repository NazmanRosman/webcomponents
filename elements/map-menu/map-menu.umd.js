!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports,require("lit"),require("@lrnwebcomponents/map-menu/lib/map-menu-builder.js"),require("@lrnwebcomponents/map-menu/lib/map-menu-container.js"),require("@lrnwebcomponents/utils/utils.js")):"function"==typeof define&&define.amd?define(["exports","lit","@lrnwebcomponents/map-menu/lib/map-menu-builder.js","@lrnwebcomponents/map-menu/lib/map-menu-container.js","@lrnwebcomponents/utils/utils.js"],n):n((e="undefined"!=typeof globalThis?globalThis:e||self).MapMenu={},e.lit,null,null,e.utils_js)}(this,(function(e,n,t,i,r){"use strict";function a(e,n){for(var t=0;t<n.length;t++){var i=n[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,(r=i.key,a=void 0,"symbol"==typeof(a=function(e,n){if("object"!=typeof e||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var i=t.call(e,n||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(r,"string"))?a:String(a)),i)}var r,a}function o(e){return o=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},o(e)}function u(e,n){return u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,n){return e.__proto__=n,e},u(e,n)}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function c(e,n){if(n&&("object"==typeof n||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return l(e)}function m(e){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,i=o(e);if(n){var r=o(this).constructor;t=Reflect.construct(i,arguments,r)}else t=i.apply(this,arguments);return c(this,t)}}function d(e,n){return n||(n=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(n)}}))}var p,s,f=function(e){!function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),n&&u(e,n)}(f,e);var t,i,o,c=m(f);function f(){var e;return function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,f),(e=c.call(this)).disabled=!1,e.title="Content outline",e.data=null,e.items=[],e.autoScroll=!1,e.activeIndicator=!1,setTimeout((function(){e.addEventListener("link-clicked",e.__linkClickedHandler.bind(l(e))),e.addEventListener("toggle-updated",e.__toggleUpdated.bind(l(e))),e.addEventListener("active-item",e.__activeItemHandler.bind(l(e))),e.addEventListener("map-meu-item-hidden-check",e._mapMeuItemHiddenCheckHandler.bind(l(e)))}),0),e}return t=f,i=[{key:"render",value:function(){return n.html(p||(p=d(['\n      <div id="itemslist">\n        <map-menu-container>\n          <div id="activeindicator"></div>\n          <map-menu-builder\n            id="builder"\n            .items="','"\n            .selected="','"\n          ></map-menu-builder>\n        </map-menu-container>\n      </div>\n    '])),this.items,this.selected)}},{key:"updated",value:function(e){var n=this;e.forEach((function(e,t){"data"==t&&n._dataChanged(n[t]),"manifest"==t&&n._manifestChanged(n[t]),"activeItem"==t&&n.refreshActiveChildren(n[t],e),["manifest","items","selected"].includes(t)&&n.dispatchEvent(new CustomEvent("".concat(t,"-changed"),{detail:{value:n[t]}}))}))}},{key:"__activeItemHandler",value:function(e){this.activeItem=e.detail}},{key:"_mapMeuItemHiddenCheckHandler",value:function(e){var n=e.detail.action,t=e.detail.hiddenChild;"closed"===n&&!0===t?this.__updateActiveIndicator(this.activeItem,!0):this.__updateActiveIndicator(this.activeItem,!1)}},{key:"refreshActiveChildren",value:function(e,n){e&&(e.setAttribute("active","active"),this.activeIndicator&&this.__updateActiveIndicator(e),this.autoScroll&&this.__scrollHandler(e,{duration:50,delay:0,scrollElement:this})),n&&(n.removeAttribute("active"),this.__updateActiveIndicator(e))}},{key:"__scrollHandler",value:function(e,n){var t={align:"top",delay:0,duration:300,scrollElement:window},i=Object.assign({},t,n),r=e.getBoundingClientRect();i.scrollElement.getBoundingClientRect();var a=i.scrollElement.getBoundingClientRect().bottom-i.scrollElement.getBoundingClientRect().top,o=r.bottom-r.top,u=i.scrollElement.scrollTop,l=e.getBoundingClientRect().top-i.scrollElement.getBoundingClientRect().top;switch(l-=a/2,i.align){case"center":l+=o/2;break;case"bottom":l+=o}var c=null;requestAnimationFrame((function e(n){null===c&&(c=n);var t,r,a,o,m=n-c,d=(t=m,r=u,a=l,o=i.duration,(t/=o/2)<1?a/2*t*t+r:-a/2*(--t*(t-2)-1)+r);i.scrollElement.scrollTop=d,m<i.duration&&requestAnimationFrame(e)}))}},{key:"_manifestChanged",value:function(e){e&&(this.data=e.items)}},{key:"_dataChanged",value:function(e){var n=this,t=[];e&&(e.forEach((function(e){e.parent||t.push(e)})),t.forEach((function(t,i){n._setChildren(t,e)})),this.items=[].concat(t))}},{key:"_setChildren",value:function(e,n){var t=this,i=n.filter((function(n){return e.id===n.parent}));e.children=i,e.children.length>0&&e.children.forEach((function(e){t._setChildren(e,n)}))}},{key:"__hasChildren",value:function(e){return e.children.length>0}},{key:"__linkClickedHandler",value:function(e){this.selected=e.detail.id,this.dispatchEvent(new CustomEvent("selected",{bubbles:!0,cancelable:!0,composed:!0,detail:e.detail.id}))}},{key:"__toggleUpdated",value:function(e){var n=e.detail.opened?"opened":"closed",t=r.normalizeEventPath(e)[0];void 0!==this.activeItem&&(this.__updateActiveIndicator(this.activeItem,!1),this.activeItem.dispatchEvent(new CustomEvent("map-menu-item-hidden-check",{bubbles:!0,cancelable:!0,composed:!0,detail:Object.assign({},{action:n,target:t})})))}},{key:"__isInViewport",value:function(e){var n=this.__getScrollParent(e);if(!n)return!1;var t=e.offsetTop,i=t+e.offsetHeight,r=n.offsetTop,a=r+n.offsetHeight;return i>r&&t<a}},{key:"__getScrollParent",value:function(e){return null==e?null:e.scrollHeight>e.clientHeight?e:this.__getScrollParent(e.parentNode)}},{key:"__updateActiveIndicator",value:function(e){var n=this,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];setTimeout((function(){var i=n.shadowRoot.querySelector("#activeindicator"),r=e.offsetTop,a=t?0:e.offsetHeight;i.setAttribute("style","height:".concat(a,"px;top:").concat(r,"px;"))}),200)}},{key:"__parentsHidden",value:function(e){var n=e.parentNode;return null==n?null:"MAP-MENU-SUBMENU"===n.tagName&&!n.opened||"MAP-MENU"!==n.tagName&&this.__parentsHidden(n)}}],o=[{key:"styles",get:function(){return[n.css(s||(s=d(["\n        :host {\n          --map-menu-item-active-item-color: rgba(100, 100, 255, 0.1);\n          --map-menu-size: 1;\n          display: block;\n          overflow-y: scroll;\n          position: relative;\n          height: 100%;\n          transition: all 0.1s ease-in-out;\n          opacity: 1;\n          background-color: transparent;\n        }\n        #itemslist {\n          display: var(--map-menu-items-list-display);\n          flex-direction: var(--map-menu-items-list-flex-direction);\n          flex: var(--map-menu-items-list-flex);\n        }\n        #activeindicator {\n          background: var(--map-menu-item-active-item-color);\n          transition: all 0.1s ease-in-out;\n          position: absolute;\n          pointer-events: none;\n          z-index: -1;\n          width: calc(100% + 16px);\n          margin-left: -16px;\n        }\n\n        map-menu-builder map-menu-builder map-menu-item,\n        map-menu-builder map-menu-builder map-menu-submenu {\n          border-left: 16px solid\n            var(--map-menu-expanded-color-depth-1, rgba(0, 0, 0, 0.02));\n        }\n        map-menu-builder map-menu-builder map-menu-builder map-menu-item,\n        map-menu-builder map-menu-builder map-menu-builder map-menu-submenu {\n          border-left: 16px solid\n            var(--map-menu-expanded-color-depth-2, rgba(0, 0, 0, 0.04));\n        }\n        map-menu-builder\n          map-menu-builder\n          map-menu-builder\n          map-menu-builder\n          map-menu-item,\n        map-menu-builder\n          map-menu-builder\n          map-menu-builder\n          map-menu-builder\n          map-menu-submenu {\n          border-left: 16px solid\n            var(--map-menu-expanded-color-depth-3, rgba(0, 0, 0, 0.06));\n        }\n        map-menu-builder\n          map-menu-builder\n          map-menu-builder\n          map-menu-builder\n          map-menu-builder\n          map-menu-item,\n        map-menu-builder\n          map-menu-builder\n          map-menu-builder\n          map-menu-builder\n          map-menu-builder\n          map-menu-submenu {\n          border-left: 16px solid\n            var(--map-menu-expanded-color-depth-4, rgba(0, 0, 0, 0.08));\n        }\n\n        map-menu-builder map-menu-submenu[opened] {\n          --map-menu-border-depth: var(\n            --map-menu-expanded-color-depth-1,\n            rgba(0, 0, 0, 0.02)\n          );\n        }\n        map-menu-builder map-menu-builder map-menu-submenu[opened] {\n          --map-menu-border-depth: var(\n            --map-menu-expanded-color-depth-2,\n            rgba(0, 0, 0, 0.04)\n          );\n        }\n        map-menu-builder\n          map-menu-builder\n          map-menu-builder\n          map-menu-submenu[opened] {\n          --map-menu-border-depth: var(\n            --map-menu-expanded-color-depth-3,\n            rgba(0, 0, 0, 0.06)\n          );\n        }\n        map-menu-builder\n          map-menu-builder\n          map-menu-builder\n          map-menu-builder\n          map-menu-submenu[opened] {\n          --map-menu-border-depth: var(\n            --map-menu-expanded-color-depth-4,\n            rgba(0, 0, 0, 0.08)\n          );\n        }\n\n        map-menu-container {\n          padding: var(--map-menu-container-padding, 0);\n          display: var(--map-menu-container-display);\n          flex-direction: var(--map-menu-container-flex-direction);\n          flex: var(--map-menu-container-flex);\n          background-color: var(--map-menu-container-background-color);\n          color: var(--map-menu-container-color);\n        }\n\n        /* turn default active color if indicator is on */\n        :host([active-indicator]) map-menu-builder {\n          --map-menu-item-active-item-color: transparent;\n        }\n      "])))]}},{key:"tag",get:function(){return"map-menu"}},{key:"properties",get:function(){return{disabled:{type:Boolean,reflect:!0},title:{type:String},data:{type:Array},manifest:{type:Object},items:{type:Array},selected:{type:String},activeItem:{type:Object},autoScroll:{type:Boolean,attribute:"auto-scroll"},activeIndicator:{type:Boolean,reflect:!0,attribute:"active-indicator"}}}}],i&&a(t.prototype,i),o&&a(t,o),Object.defineProperty(t,"prototype",{writable:!1}),f}(n.LitElement);customElements.define(f.tag,f),e.MapMenu=f,Object.defineProperty(e,"__esModule",{value:!0})}));
