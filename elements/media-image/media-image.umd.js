!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@lrnwebcomponents/image-inspector/image-inspector.js"),require("lit"),require("@lrnwebcomponents/schema-behaviors/schema-behaviors.js"),require("@lrnwebcomponents/simple-modal/lib/simple-modal-handler.js"),require("@lrnwebcomponents/figure-label/figure-label.js")):"function"==typeof define&&define.amd?define(["exports","@lrnwebcomponents/image-inspector/image-inspector.js","lit","@lrnwebcomponents/schema-behaviors/schema-behaviors.js","@lrnwebcomponents/simple-modal/lib/simple-modal-handler.js","@lrnwebcomponents/figure-label/figure-label.js"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).MediaImage={},null,e.lit,e.schemaBehaviors_js,e.simpleModalHandler_js)}(this,(function(e,t,n,i,o){"use strict";function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,w(i.key),i)}}function s(e,t,n){return t&&c(e.prototype,t),n&&c(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function u(e,t,n){return(t=w(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function d(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f(e,t)}function p(e){return p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},p(e)}function f(e,t){return f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},f(e,t)}function m(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function g(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return m(e)}function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=p(e);if(t){var o=p(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return g(this,n)}}function b(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=p(e)););return e}function y(){return y="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var i=b(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},y.apply(this,arguments)}function v(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function w(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var x,k,O,j,_,L,S,C,T,P,E,D=function(e){d(i,e);var t=h(i);function i(){var e;return l(this,i),(e=t.call(this)).disableZoom=!1,e.modalTitle="",e.source="",e.citation="",e.caption="",e.figureLabelTitle="",e.figureLabelDescription="",e.alt="",e.size="wide",e.round=!1,e.card=!1,e.box=!1,e.offset="none",e}return s(i,[{key:"updated",value:function(e){var t=this;e.forEach((function(e,n){"caption"==n&&t._computeHasCaption(t[n]),["figureLabelTitle","figureLabelDescription"].includes(n)&&(t.__figureLabel=t._hasFigureLabel(t.figureLabelTitle,t.figureLabelDescription)),["figureLabelTitle","caption"].includes(n)&&(t.modalTitle=t.figureLabelTitle?t.figureLabelTitle:t.caption,t.modalTitle+=t.figureLabelDescription?" - "+t.figureLabelDescription:"")}))}},{key:"render",value:function(){return n.html(x||(x=v(["\n      ",'\n      <media-image-image\n        ?round="','"\n        resource="','-image"\n        source="','"\n        modal-title="','"\n        alt="','"\n        .described-by="','"\n        tabindex="','"\n        @click="','"\n      ></media-image-image>\n      <media-image-citation>\n        <slot name="citation"> '," </slot>\n      </media-image-citation>\n      ","\n    "])),this.__figureLabel?n.html(k||(k=v(['\n            <figure-label\n              title="','"\n              description="','"\n            ></figure-label>\n          '])),this.figureLabelTitle,this.figureLabelDescription):"",this.round,this.schemaResourceID,this.source,this.modalTitle,this.alt,this.describedBy,this.disableZoom?"-1":"0",this._handleClick,this.citation,this._hasCaption?n.html(O||(O=v(['\n            <media-image-caption>\n              <slot name="caption"> '," </slot>\n            </media-image-caption>\n          "])),this.caption):"")}},{key:"haxHooks",value:function(){return{editModeChanged:"haxEditModeChanged",activeElementChanged:"haxActiveElementChanged"}}},{key:"_handleClick",value:function(e){(this._haxState||this.disableZoom)&&(e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation())}},{key:"haxEditModeChanged",value:function(e){this._haxState=e}},{key:"haxActiveElementChanged",value:function(e,t){t&&(this._haxState=t)}},{key:"_hasFigureLabel",value:function(e,t){return e&&e.length>0||t&&t.length>0}},{key:"_computeHasCaption",value:function(){this._hasCaption=this.caption.length>0||null!==this.querySelector('[slot="caption"]')}},{key:"connectedCallback",value:function(){var e=this;y(p(i.prototype),"connectedCallback",this).call(this),this._observer=new MutationObserver((function(t){e._computeHasCaption()})),this._observer.observe(this,{childList:!0})}},{key:"disconnectedCallback",value:function(){this._observer.disconnect(),y(p(i.prototype),"disconnectedCallback",this).call(this)}}],[{key:"styles",get:function(){return[n.css(j||(j=v(['\n        :host {\n          display: block;\n          width: auto;\n          margin: auto;\n          max-width: 600px;\n          --box-background-color: #f7f6ef;\n        }\n\n        :host([card]) {\n          box-shadow: 0 1px 5px rgba(0, 0, 0, 0.14);\n          padding: 20px;\n        }\n\n        :host([box]) {\n          background-color: var(--box-background-color);\n          padding: 20px;\n        }\n        @media screen and (min-width: 650px) {\n          :host([size="small"]) {\n            max-width: 35%;\n          }\n        }\n\n        @media screen and (min-width: 900px) {\n          :host([size="small"]) {\n            max-width: 25%;\n          }\n        }\n\n        :host([offset="left"]) {\n          float: left;\n          margin: var(--media-image-offset-width, 1.5vw);\n          margin-left: calc(-2 * var(--media-image-offset-width, 1.5vw));\n          padding-left: calc(4 * var(--media-image-offset-width, 1.5vw));\n          margin-top: 0;\n          margin-bottom: calc(0.1 * var(--media-image-offset-width, 1.5vw));\n        }\n\n        :host([offset="right"]) {\n          float: right;\n          margin: var(--media-image-offset-width, 1.5vw);\n          margin-right: calc(-2 * var(--media-image-offset-width, 1.5vw));\n          padding-right: calc(4 * var(--media-image-offset-width, 1.5vw));\n          margin-top: 0;\n          margin-bottom: calc(0.1 * var(--media-image-offset-width, 1.5vw));\n        }\n\n        :host([offset="wide"]) {\n          margin: 0 calc(-1 * var(--media-image-offset-wide-width, 3.5vw));\n          max-width: 100vw;\n        }\n\n        :host([offset="narrow"]) {\n          max-width: var(--media-image-offset-narrow-max-width, 500px);\n          margin: auto;\n        }\n\n        media-image-caption {\n          max-height: 100px;\n          padding-bottom: 20px;\n          border-bottom: dashed 2px lightgray;\n          margin-bottom: 20px;\n        }\n        :host(:not([disable-zoom])) media-image-image:hover {\n          cursor: pointer;\n        }\n      '])))]}},{key:"tag",get:function(){return"media-image"}},{key:"properties",get:function(){return a(a({},y(p(i),"properties",this)),{},{__figureLabel:{type:Boolean},modalTitle:{type:String},disableZoom:{type:Boolean,attribute:"disable-zoom",reflect:!0},_hasCaption:{type:Boolean},source:{type:String},citation:{type:String},describedBy:{type:String,attribute:"described-by"},caption:{type:String},alt:{type:String},size:{type:String,reflect:!0},round:{type:Boolean},card:{type:Boolean,reflect:!0},box:{type:Boolean,reflect:!0},offset:{type:String,reflect:!0},figureLabelTitle:{type:String,attribute:"figure-label-title"},figureLabelDescription:{type:String,attribute:"figure-label-description"}})}},{key:"haxProperties",get:function(){return{canScale:!0,canPosition:!1,canEditSource:!0,gizmo:{title:"Image",descrption:"A way of presenting images with various enhancements.",icon:"editor:insert-photo",color:"indigo",tags:["Images","media","core","figure","image","caption","presentation","design"],handles:[{type:"image",type_exclusive:!0,source:"source",title:"alt",alt:"alt",citation:"citation",caption:"caption"}],meta:{author:"HAXTheWeb core team",outlineDesigner:!0}},settings:{configure:[{property:"source",title:"Source",description:"The URL for the image.",inputMethod:"haxupload",required:!0},{property:"alt",title:"Alternative text",description:"Text to describe the image to non-sighted users.",inputMethod:"alt",required:!0},{property:"card",title:"Card",description:"Apply a drop shadow to give the appearance of being a raised card.",inputMethod:"boolean",required:!1},{property:"box",title:"Box",description:"Apply a visual box around the image.",inputMethod:"boolean",required:!1},{property:"offset",title:"Offset",description:"Apply a left or right offset to the image.",inputMethod:"select",options:{none:"none",wide:"wide",narrow:"narrow"}},{property:"citation",title:"Citation",description:"Citation for the image.",inputMethod:"textfield",required:!1},{property:"caption",title:"Caption",description:"Caption for the image.",inputMethod:"textfield",required:!1},{property:"figureLabelTitle",title:"Figure Label Title",description:"Title for the figure label.",inputMethod:"textfield",required:!1},{property:"figureLabelDescription",title:"Figure Label Description",description:"Description for the figure label.",inputMethod:"textfield",required:!1}],advanced:[{property:"round",title:"Round image",description:"Crops the image appearance to be circle in shape.",inputMethod:"boolean",required:!1},{property:"disableZoom",title:"Disable image modal",description:"Disable clicks opening the image in an image inspector dialog.",inputMethod:"boolean",required:!1}]},demoSchema:[{tag:"media-image",properties:{source:"https://dummyimage.com/300x200/000/fff",card:!0,citation:"This is my citation."}}]}}}]),i}(i.SchemaBehaviors(n.LitElement));customElements.define(D.tag,D);var M=function(e){d(i,e);var t=h(i);function i(){var e;return l(this,i),(e=t.call(this)).round=!1,e.modalContent=document.createElement("image-inspector"),e.modalContent.noLeft=!0,e.modalTitle="",setTimeout((function(){e.addEventListener("simple-modal-show",e.__modalShowEvent.bind(m(e)))}),0),e}return s(i,[{key:"__modalShowEvent",value:function(e){}},{key:"render",value:function(){return n.html(_||(_=v(['\n      <div class="image-wrap">\n        <img\n          src="','"\n          alt="','"\n          aria-describedby="','"\n          loading="lazy"\n        />\n      </div>\n    '])),this.source,this.alt,this.describedBy||"")}},{key:"updated",value:function(e){var t=this;e.forEach((function(e,n){"source"==n&&(t.modalContent.src=t[n])}))}}],[{key:"styles",get:function(){return[n.css(L||(L=v(["\n        :host {\n          display: block;\n        }\n        .image-wrap {\n          overflow: hidden;\n        }\n        .image-wrap img {\n          width: 100%;\n        }\n        :host([round]) .image-wrap {\n          border-radius: 50%;\n        }\n      "])))]}},{key:"properties",get:function(){return{source:{type:String},alt:{type:String},describedBy:{type:String,attribute:"described-by"},round:{type:Boolean,reflect:!0},modalTitle:{type:String,attribute:"modal-title"}}}},{key:"tag",get:function(){return"media-image-image"}}]),i}(o.SimpleModalHandler(n.LitElement));customElements.define(M.tag,M);var q=function(e){d(i,e);var t=h(i);function i(){return l(this,i),t.apply(this,arguments)}return s(i,[{key:"render",value:function(){return n.html(S||(S=v([' <div class="citation"><slot></slot></div> '])))}}],[{key:"styles",get:function(){return[n.css(C||(C=v(["\n        :host {\n          display: block;\n          overflow: auto;\n        }\n\n        .citation {\n          font-size: 13.3333px;\n          line-height: 24px;\n          font-weight: 400;\n          font-style: italic;\n          color: #4c4c4c;\n          margin: 15px 0 15px;\n        }\n      "])))]}},{key:"tag",get:function(){return"media-image-citation"}}]),i}(n.LitElement);customElements.define(q.tag,q);var B=function(e){d(i,e);var t=h(i);function i(){return l(this,i),t.apply(this,arguments)}return s(i,[{key:"render",value:function(){return n.html(T||(T=v(['\n      <div class="caption">\n        ',"\n      </div>\n    "])),this.__hasContent?"":n.html(P||(P=v([' <slot id="slot"></slot> ']))))}}],[{key:"styles",get:function(){return[n.css(E||(E=v(["\n        :host {\n          display: block;\n          overflow: auto;\n        }\n\n        .caption {\n          line-height: 28.8px;\n          font-size: 16px;\n          font-weight: 400;\n        }\n\n        .caption ::slotted(*) {\n          margin-top: 0;\n        }\n        .caption ::slotted(*:last-child) {\n          margin-bottom: 0;\n        }\n      "])))]}},{key:"tag",get:function(){return"media-image-caption"}}]),i}(n.LitElement);customElements.define(B.tag,B),e.MediaImage=D,Object.defineProperty(e,"__esModule",{value:!0})}));
