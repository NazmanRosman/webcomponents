!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("lit"),require("@lrnwebcomponents/simple-colors/simple-colors.js"),require("@lrnwebcomponents/schema-behaviors/schema-behaviors.js"),require("@lrnwebcomponents/media-behaviors/media-behaviors.js"),require("@lrnwebcomponents/intersection-element/lib/IntersectionObserverMixin.js"),require("@lrnwebcomponents/a11y-media-player/a11y-media-player.js"),require("@lrnwebcomponents/i18n-manager/lib/I18NMixin.js")):"function"==typeof define&&define.amd?define(["exports","lit","@lrnwebcomponents/simple-colors/simple-colors.js","@lrnwebcomponents/schema-behaviors/schema-behaviors.js","@lrnwebcomponents/media-behaviors/media-behaviors.js","@lrnwebcomponents/intersection-element/lib/IntersectionObserverMixin.js","@lrnwebcomponents/a11y-media-player/a11y-media-player.js","@lrnwebcomponents/i18n-manager/lib/I18NMixin.js"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).VideoPlayer={},e.lit,e.simpleColors_js,e.schemaBehaviors_js,e.mediaBehaviors_js,e.IntersectionObserverMixin_js,null,e.I18NMixin_js)}(this,(function(e,t,i,r,o,n,a,s){"use strict";function c(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function l(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?c(Object(i),!0).forEach((function(t){p(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):c(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function d(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,S(r.key),r)}}function p(e,t,i){return(t=S(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function h(e){return h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},h(e)}function y(e,t){return y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},y(e,t)}function f(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function b(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return f(e)}function m(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,r=h(e);if(t){var o=h(this).constructor;i=Reflect.construct(r,arguments,o)}else i=r.apply(this,arguments);return b(this,i)}}function g(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=h(e)););return e}function v(){return v="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,i){var r=g(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:i):o.value}},v.apply(this,arguments)}function k(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function w(e){return function(e){if(Array.isArray(e))return T(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return T(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return Array.from(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return T(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function T(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,r=new Array(t);i<t;i++)r[i]=e[i];return r}function S(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var O,_,M,j,P,D,x,C,R,E,I,B=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&y(e,t)}(a,e);var i,r,o,n=m(a);function a(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(e=n.call(this)).sourceType="",e.crossorigin="anonymous",e.dark=!1,e.darkTranscript=!1,e.disableInteractive=!1,e.hideTimestamps=!1,e.hideTranscript=!1,e.hideYoutubeLink=!1,e.lang="en",e.playing=!1,e.__setVisChange=!1,e.allowBackgroundPlay=!1,e.learningMode=!1,e.linkable=!1,e.sources=[],e.stickyCorner="none",e.tracks=[],e.source="",e.observer.observe(f(e),{childList:!0,subtree:!1}),e.t=e.t||{},e.t=l(l({},e.t),{},{embeddedMedia:"embedded media"}),e.registerLocalization({context:f(e),localesPath:new URL("./locales","undefined"==typeof document&&"undefined"==typeof location?new(require("url").URL)("file:"+__filename).href:"undefined"==typeof document?location.href:document.currentScript&&document.currentScript.src||new URL("video-player.umd.js",document.baseURI).href).href,locales:["es"]}),e}return i=a,o=[{key:"styles",get:function(){return[].concat(w(v(h(a),"styles",this)),[t.css(I||(I=k(["\n        :host {\n          display: block;\n          margin: 0 0 15px;\n          line-height: 16px !important;\n          font-size: 16px !important;\n        }\n\n        .video-caption {\n          font-style: italic;\n          margin: 0;\n          padding: 8px;\n        }\n      "])))])}},{key:"haxProperties",get:function(){return{canScale:{min:25,step:12.5},canPosition:!0,canEditSource:!0,gizmo:{title:"Video",description:"This can present video in a highly accessible manner regardless of source.",icon:"av:play-circle-filled",color:"red",groups:["Video","Media"],handles:[{type:"video",type_exclusive:!0,source:"source",title:"caption",caption:"caption",description:"caption",color:"primaryColor"}],meta:{author:"HAXTheWeb core team",outlineDesigner:!0}},settings:{configure:[{property:"source",title:"Source",description:"The URL for this media.",inputMethod:"haxupload",noCamera:!0,noVoiceRecord:!0,validationType:"url"},{property:"track",title:"Closed captions",description:"The URL for the captions file.",inputMethod:"haxupload",noCamera:!0,noVoiceRecord:!0,validationType:"url"},{property:"thumbnailSrc",title:"Thumbnail image",description:"Optional. The URL for a thumbnail/poster image.",inputMethod:"haxupload",noVoiceRecord:!0,validationType:"url"},{property:"mediaTitle",title:"Title",description:"Simple title for under video",inputMethod:"textfield",validationType:"text"},{property:"accentColor",title:"Accent color",description:"Select the accent color for the player.",inputMethod:"colorpicker"},{property:"dark",title:"Dark theme",description:"Enable dark theme for the player.",inputMethod:"boolean"}],advanced:[{property:"crossorigin",title:"Crossorigin",description:"Indicates whether to use CORS.",inputMethod:"select",options:{"":"",anonymous:"anonymous","use-credentials":"use-credentials"}},{property:"allowBackgroundPlay",title:"Allow background playback",description:"Videos pause / play automatically when tab loses focus; this enables video to play without tab having focus",inputMethod:"boolean"},{property:"learningMode",title:"Enable learning mode",description:"Disables fast forward and rewind.",inputMethod:"boolean"},{property:"darkTranscript",title:"Dark theme for transcript",description:"Enable dark theme for the transcript.",inputMethod:"boolean"},{property:"disableInteractive",title:"Disable Interactive",description:"Disable interactive mode that makes transcript clickable.",inputMethod:"boolean"},{property:"height",title:"Height",inputMethod:"textfield",required:!1,validationType:"text"},{property:"hideTimestamps",title:"Hide timestamps",description:"Hide the time stamps on the transcript.",inputMethod:"boolean"},{property:"hideTranscript",title:"Hide Transcript",description:"Hide transcript by default.",inputMethod:"boolean"},{property:"lang",title:"Language",description:"Language of the media.",inputMethod:"textfield",validationType:"text"},{property:"linkable",title:"Include a share link?",description:"Provides a link to share the video.",inputMethod:"boolean"},{property:"hideYoutubeLink",title:"Remove open on YouTube button",description:"Removes the button for opening the video on YouTube.",inputMethod:"boolean"},{property:"stickyCorner",title:"Sticky Corner",description:"Set the corner where a video plays when scrolled out of range, or choose none to disable sticky video.",inputMethod:"select",options:{none:"none","top-left":"top-left","top-right":"top-right","bottom-left":"bottom-left","bottom-right":"bottom-right"}},{property:"sources",title:"Other sources",description:"List of other sources",inputMethod:"array",properties:[{property:"src",title:"Source",description:"The URL for this source.",inputMethod:"haxupload",required:!0,noCamera:!0,noVoiceRecord:!0,validationType:"url"},{property:"type",title:"Type",description:"Media type data",inputMethod:"select",options:{"audio/aac":"acc audio","audio/flac":"flac audio","audio/mp3":"mp3 audio","video/mp4":"mp4 video","video/mov":"mov video","audio/ogg":"ogg audio","video/ogg":"ogg video","audio/wav":"wav audio","audio/webm":"webm audio","video/webm":"webm video"}}]},{property:"tracks",title:"Track list",description:"Tracks of different languages of closed captions",inputMethod:"array",properties:[{property:"kind",title:"Kind",description:"Kind of track",inputMethod:"select",options:{subtitles:"subtitles"}},{property:"label",title:"Label",description:'The human-readable name for this track, eg. "English Subtitles"',inputMethod:"textfield"},{property:"src",title:"Source",description:"The source for the captions file.",inputMethod:"haxupload",required:!1,noCamera:!0,noVoiceRecord:!1,validationType:"url"},{property:"srclang",title:'Two letter, language code, eg. \'en\' for English, "de" for German, "es" for Spanish, etc.',description:"Label",inputMethod:"textfield"}]},{property:"width",title:"width",inputMethod:"textfield",required:!1,validationType:"text"}]},saveOptions:{unsetAttributes:["__utils","__stand-alone","colors"]},demoSchema:[{tag:"video-player",properties:{accentColor:"orange",dark:!0,crossorigin:"anonymous",source:"https://www.youtube.com/watch?v=LrS7dqokTLE",track:"https://haxtheweb.org/files/HAXshort.vtt"},content:""}]}}},{key:"properties",get:function(){return l(l({},v(h(a),"properties",this)),{},{sourceType:{type:String},accentColor:{type:String,attribute:"accent-color",reflect:!0},crossorigin:{type:String,attribute:"crossorigin",reflect:!0},dark:{type:Boolean,attribute:"dark",reflect:!0},darkTranscript:{type:Boolean},disableInteractive:{type:Boolean},height:{type:String},hideTimestamps:{type:Boolean,attribute:"hide-timestamps"},hideTranscript:{type:Boolean,attribute:"hide-transcript"},id:{type:String,attribute:"id",reflect:!0},learningMode:{type:Boolean,attribute:"learning-mode"},lang:{type:String},linkable:{type:Boolean},mediaTitle:{type:String,attribute:"media-title",reflect:!0},hideYoutubeLink:{type:Boolean,attribute:"hide-youtube-link"},source:{type:String,reflect:!0},sources:{type:Array},stickyCorner:{type:String,attribute:"sticky-corner",reflect:!0},track:{type:String},tracks:{type:Array},thumbnailSrc:{type:String,attribute:"thumbnail-src",reflect:!0},width:{type:String},playing:{type:Boolean,reflect:!0},allowBackgroundPlay:{type:Boolean,reflect:!0,attribute:"allow-background-play"}})}},{key:"tag",get:function(){return"video-player"}}],(r=[{key:"render",value:function(){return t.html(O||(O=k([" ",""])),this.elementVisible?t.html(_||(_=k(["",""])),this.isA11yMedia?t.html(C||(C=k([' <a11y-media-player\n                accent-color="','"\n                ?audio-only="','"\n                ?dark="','"\n                ?dark-transcript="','"\n                ?disable-interactive="','"\n                ?hide-timestamps="','"\n                ?hide-transcript="','"\n                ?hide-youtube-link="','"\n                id="','"\n                @play="','"\n                @pause="','"\n                lang="','"\n                ?learning-mode="','"\n                ?linkable="','"\n                preload="metadata"\n                media-title="','"\n                .sources="','"\n                ?stand-alone="','"\n                sticky-corner="','"\n                .thumbnail-src="','"\n                .tracks="','"\n                .crossorigin="','"\n                .width="','"\n                .height="','"\n                youtube-id="','"\n              >\n              </a11y-media-player\n              ><slot hidden></slot>'])),this.accentColor,this.audioOnly,this.dark,this.darkTranscript,this.disableInteractive,this.hideTimestamps,this.hideTranscript,this.hideYoutubeLink,this.playerId,this.playEvent,this.pauseEvent,this.lang||"en",this.learningMode,this.linkable,this.mediaTitle||"",this.sourceProperties,this.standAlone,this.stickyCorner||"none",this.thumbnailSrc,this.trackProperties,this.crossorigin||"anonymous",this.width,this.height,this.youtubeId):t.html(M||(M=k([' <div\n                class="responsive-video-container"\n                .lang="','"\n              >\n                ',"\n                ",'\n              </div>\n              <div id="videocaption" class="video-caption">\n                <p>\n                  ','\n                  <span class="media-type print-only"\n                    >(',')</span\n                  >\n                </p>\n                <slot name="caption"></slot>\n              </div>\n              <slot hidden></slot>'])),this.lang||void 0,this.sandboxed?t.html(j||(j=k([""]))):t.html(P||(P=k([' <webview\n                      resource="','-video"\n                      .src="','"\n                      .width="','"\n                      .height="','"\n                      frameborder="0"\n                    >\n                    </webview>'])),this.schemaResourceID,this.sourceData&&this.sourceData[0]&&this.sourceData[0].src||void 0,this.width||void 0,this.height||void 0),this.sandboxed||!this.iframed?t.html(D||(D=k([""]))):t.html(x||(x=k(['\n                      <iframe\n                        loading="lazy"\n                        resource="','-video"\n                        .src="','"\n                        width="','"\n                        height="','"\n                        frameborder="0"\n                        webkitallowfullscreen=""\n                        mozallowfullscreen=""\n                        allowfullscreen=""\n                      ></iframe>\n                    '])),this.schemaResourceID,this.sourceData&&this.sourceData[0]&&this.sourceData[0].src||void 0,this.width,this.height),this.mediaTitle,this.t.embeddedMedia)):"")}},{key:"disconnectedCallback",value:function(){this.__setVisChange&&(this.__setVisChange=!1,document.removeEventListener("visibilitychange",this._visChange.bind(this))),this.observer&&this.observer.disconnect&&this.observer.disconnect(),v(h(a.prototype),"disconnectedCallback",this).call(this)}},{key:"html5",get:function(){return t.html(R||(R=k(["\n      ","\n      ","\n    "])),this.sourceData.filter((function(e){return"youtube"!==e.type})).map((function(e){t.html(E||(E=k(['\n            <source\n              .src="','"\n              .type="','"\n            />\n          '])),e.src||void 0,e.type||void 0)})),this.trackData.map((function(e){'<track\n           .src="'.concat(e.src||void 0,'"\n           .kind="').concat(e.kind||void 0,'"\n           .label="').concat(e.label||void 0,'"\n           .srclang="').concat(e.lang||void 0,'"\n         />')})))}},{key:"iframed",get:function(){return!(!(this.sourceData&&this.sourceData.length>0&&void 0!==this.sourceData[0]&&window.MediaBehaviors.Video._sourceIsIframe(this.sourceData[0].src))||this.sandboxed)}},{key:"isA11yMedia",get:function(){return!this.sandboxed&&("youtube"==this.sourceType||"local"==this.sourceType||this.sourceData.length<1)}},{key:"observer",get:function(){var e=this;return new MutationObserver((function(){return e.setSourceData()}))}},{key:"sandboxed",get:function(){return!!(this.sourceData&&this.sourceData.length>0&&void 0!==u(this.sourceData[0])&&window.MediaBehaviors.Video._sourceIsIframe(this.sourceData[0].src)&&"function"==typeof document.createElement("webview").reload)}},{key:"sourceProperties",get:function(){var e=this,t="string"==typeof this.sources?JSON.parse(this.sources):(this.sources||[]).slice();return this.source&&t.unshift({src:this.source}),t&&t.length>0&&t.forEach((function(t){t.type=t.type||e._computeMediaType(t.src),t.src=e._computeSRC(t.src,t.type)})),t}},{key:"trackProperties",get:function(){var e=this,t="string"==typeof this.tracks?JSON.parse(this.tracks):(this.tracks||[]).slice();return this.track&&t.unshift({src:this.track}),t&&t.length>0&&t.forEach((function(t){t.srclang=t.srclang||e.lang,t.kind=t.kind||"subtitles",t.label=t.label||t.kind||t.lang})),t}},{key:"sourceData",get:function(){var e=this,t=(this.sourceProperties||[]).slice();return this.querySelectorAll("video source, audio source, iframe").forEach((function(t){e.sources.filter((function(e){return e.src===t.src})).length<1&&e.sources.unshift({src:t.src,type:t.type||e._computeMediaType(t.src)})})),t}},{key:"audioOnly",get:function(){return this.sourceData.filter((function(e){return e.type.indexOf("audio")>-1})).length>1}},{key:"standAlone",get:function(){return void 0===this.trackData||null===this.trackData||this.trackData.length<1}},{key:"trackData",get:function(){var e=this,t="string"==typeof this.tracks?(JSON.parse(this.tracks)||[]).slice():(this.tracks||[]).slice();return this.querySelectorAll("video track, audio track").forEach((function(t){if(e.tracks.filter((function(e){return e.src===t.src})).length<1){var i={src:t.src};t.lang&&(i.lang=t.lang),t.srclang&&(i.srclang=t.srclang),t.label&&(i.label=t.label),t.kind&&(i.kind=t.kind),e.tracks.unshift(i)}t.remove()})),void 0!==this.track&&null!==this.track&&""!==this.track&&t.push({src:this.track,srclang:this.lang,label:"en"===this.lang?"English":this.lang,kind:"subtitles"}),t}},{key:"youtubeId",get:function(){if(this.sourceData&&this.sourceData[0]&&"youtube"===this.sourceType)return this._computeSRC(this.sourceData[0].src).replace(/.*\/embed\//,"")}},{key:"playerId",get:function(){return"".concat(this.id||this.schemaResourceID,"-media")}},{key:"_computeMediaType",value:function(e){var t="",i=function(i,r){r.forEach((function(r){""===t&&void 0!==u(e)&&null!==e&&e.toLowerCase().indexOf("."+r)>-1&&(t=i+"/"+r)}))};return i("audio",["aac","flac","mp3","oga","wav"]),i("video",["mov","mp4","ogv","webm"]),t}},{key:"_computeSRC",value:function(e,t){return null!==e&&void 0!==u(e)&&(t=t||window.MediaBehaviors.Video.getVideoType(e),e=window.MediaBehaviors.Video.cleanVideoSource(e,t),"vimeo"==t&&(this.vimeoTitle?e+="?title=1":e+="?title=0",this.vimeoByline?e+="&byline=1":e+="&byline=0",this.vimeoPortrait?e+="&portrait=1":e+="&portrait=0")),e}},{key:"haxHooks",value:function(){return{postProcessNodeToContent:"haxpostProcessNodeToContent"}}},{key:"haxpostProcessNodeToContent",value:function(e){return e=(e=e.replace(' sources="[]",',"")).replace(' tracks="[]",',"")}},{key:"setSourceData",value:function(){var e=this.source;this.source="",this.source=e}},{key:"playEvent",value:function(e){this.playing=e.detail.__playing}},{key:"pauseEvent",value:function(e){this.playing=e.detail.__playing}},{key:"firstUpdated",value:function(e){var t=this;v(h(a.prototype),"firstUpdated",this)&&v(h(a.prototype),"firstUpdated",this).call(this,e),e.forEach((function(e,i){"allowBackgroundPlay"===i&&t[i]&&t.__setVisChange?(t.__setVisChange=!1,document.removeEventListener("visibilitychange",t._visChange.bind(t))):"allowBackgroundPlay"!==i||t[i]||t.__setVisChange||(t.__setVisChange=!0,document.addEventListener("visibilitychange",t._visChange.bind(t)))})),this.sourceData&&this.sourceData.length>0&&void 0!==this.sourceData[0]&&"undefined"!==u(this.sourceData[0].src)&&(this.sourceType=window.MediaBehaviors.Video.getVideoType(this.sourceData[0].src))}},{key:"_visChange",value:function(e){"visible"===document.visibilityState&&!this.playing&&this.__forcePaused?(this.__forcePaused=!1,this.shadowRoot.querySelector("a11y-media-player").togglePlay()):"hidden"===document.visibilityState&&this.playing&&(this.__forcePaused=!0,this.shadowRoot.querySelector("a11y-media-player").togglePlay())}}])&&d(i.prototype,r),o&&d(i,o),Object.defineProperty(i,"prototype",{writable:!1}),a}(n.IntersectionObserverMixin(o.MediaBehaviorsVideo(r.SchemaBehaviors(s.I18NMixin(i.SimpleColors)))));customElements.define(B.tag,B),e.VideoPlayer=B,Object.defineProperty(e,"__esModule",{value:!0})}));
